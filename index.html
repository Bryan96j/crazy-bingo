<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="screen-orientation" content="landscape" />
<meta name="x5-orientation" content="landscape" />
<meta name="full-screen" content="true" />
<meta name="x5-fullscreen" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Bingo</title>

<style>
  :root{
    --bg:#1d1f23;
    --panel-1: #2a2c31;
    --primary: #007bff;
    --highlight: #00ff2f;
    --danger: #ff5555;
    --text: #ffffff;
    --muted: #cccccc;
    --border: #3a3c42;
  }

  *{box-sizing:border-box}
  html,body{
    margin:0;
    height:100%;
    font-family: Arial, Helvetica, sans-serif;
    background: var(--bg);
    color: var(--text);
    font-size: 42px;
  }

  button {font-family:inherit;}

  .app {
    display:flex;
    height:100vh;
    width:100vw;
  }

  /* ---------- Bienvenida ---------- */
  .welcome {
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    background:rgba(0,0,0,0.8);
    flex-direction:column;
    z-index:40;
  }
  .welcome-card {
    background: var(--panel-1);
    border-radius:16px;
    padding:30px;
    text-align:center;
    border:2px solid var(--primary);
    box-shadow:0 0 20px rgba(0,0,0,0.5);
    width:min(700px,90vw);
  }
  .title {
    font-size:62px;
    font-weight:bold;
    color: var(--highlight);
    margin-bottom:10px;
  }
  .subtitle {
    color: var(--muted);
    margin-bottom:42px;
  }
  .btn-big {
    background: var(--primary);
    color:#fff;
    border:none;
    padding:14px 26px;
    border-radius:10px;
    font-size:20px;
    cursor:pointer;
  }
  .btn-small {
    background: transparent;
    color: var(--muted);
    border:1px solid var(--border);
    padding:10px 18px;
    border-radius:10px;
    cursor:pointer;
  }

  /* ---------- Modales ---------- */
  .overlay {
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.6);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:60;
  }
  .overlay.show {display:flex;}
  .modal {
    background: var(--panel-1);
    border:2px solid var(--primary);
    border-radius:12px;
    padding:20px;
    width:min(480px,90vw);
    text-align:center;
  }
  .modal h3{color:var(--highlight); margin:0 0 10px;}
  .modal p{color:var(--muted); margin-bottom:20px;}
  .modal .modal-actions{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
  .btn {padding:10px 16px;border-radius:8px;border:none;cursor:pointer;font-size:16px;}
  .btn-accept {background:var(--primary);color:#fff;}
  .btn-cancel {background:#444;color:#fff;}
  .btn-danger {background:var(--danger);color:#fff;}

  /* ---------- Layout ---------- */
  .left {
    width:20%; /* M√°s reducido a√∫n */
    background: var(--panel-1);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:10px;
    padding:10px;
    border-right:2px solid var(--border);
  }
  .right {
    width:80%; /* M√°s espacio para el tablero */
    padding:10px;
    overflow-y:auto;
  }

  #current-number {
    font-size: clamp(50px, 12vw, 120px); /* M√°s peque√±o */
    font-weight:bold;
    color: var(--highlight);
    text-shadow: 0 0 10px rgba(255,255,255,0.3);
    text-align: center;
  }

  .controls {
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:8px;
    width: 100%;
  }
  
  /* Teclado virtual para evitar que aparezca el teclado del sistema */
  .virtual-keyboard {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
    width: 100%;
    max-width: 180px;
  }
  
  .key {
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 0;
    font-size: 16px;
    cursor: pointer;
    min-height: 35px;
  }
  
  .key-wide {
    grid-column: span 2;
  }

  .key-delete {
    background: var(--danger);
  }

  .key-enter {
    background: var(--highlight);
    color: #000;
  }

  .number-display {
    width: 100%;
    max-width: 180px;
    font-size: 24px;
    padding: 8px;
    border-radius: 8px;
    text-align: center;
    border: 2px solid var(--primary);
    background: #fff;
    color: #000;
    margin-bottom: 5px;
  }

  .row {
    display:flex;
    gap:5px;
    justify-content: center;
    width: 100%;
  }

  .btn-accept {
    background: var(--primary);
    color:#fff;
    border:none;
    font-size:16px;
    padding:8px 12px;
    border-radius:8px;
    cursor:pointer;
    flex: 1;
  }
  .btn-bingo {
    background: var(--highlight);
    color:#000;
    border:none;
    font-size:14px;
    padding:8px 12px;
    border-radius:8px;
    cursor:pointer;
    flex: 1;
  }

  #board {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(30px, 1fr)); /* M√°s peque√±o */
    grid-auto-rows: 30px; /* M√°s peque√±o */
    gap: 4px;
    justify-items: center;
    align-items: center;
    height: 100%;
    width: 100%;
    overflow: auto;
  }
  .number {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #eee;
    color: #000;
    font-size: 12px; /* M√°s peque√±o */
    border-radius: 4px;
    border: 1px solid #ccc;
    cursor: pointer;
    transition: transform 0.2s ease;
  }
  .number.marked {
    background: var(--highlight);
    color: #000;
    font-weight: bold;
    border-color: #000;
    transform: scale(1.1);
  }

  .restart-fixed {
    position:fixed;
    left:10px;
    bottom:10px;
    z-index:80;
  }
  .restart-btn {
    width:40px;
    height:40px;
    border-radius:50%;
    background: var(--primary);
    color:#fff;
    font-size:20px;
    border:none;
    cursor:pointer;
  }

  .muted-help{color:var(--muted);font-size:10px;text-align:center;}

  @media (max-width:720px){
    .app{flex-direction:column;}
    .left,.right{width:100%;}
    .left{height:25vh;} /* M√≠nimo espacio para controles */
    .right{height:75vh;} /* M√°ximo espacio para tablero */
    
    /* Ajustes adicionales para m√≥viles */
    #current-number {
      font-size: clamp(40px, 15vw, 80px);
    }
    
    #board {
      grid-template-columns: repeat(auto-fill, minmax(25px, 1fr));
      grid-auto-rows: 25px;
      gap: 3px;
    }
    
    .number {
      font-size: 10px;
    }
    
    .virtual-keyboard {
      max-width: 100%;
    }
  }
</style>
</head>
<body>

<!-- ---------- Bienvenida ---------- -->
<div class="welcome" id="welcomeScreen">
  <div class="welcome-card">
    <div class="title">Crazy Bingo</div>
    <div class="subtitle">No nos hacemos responsables por los da√±os y peleas</div>
    <p style="color:var(--muted)">Ideal para proyectar en TV y jugar.</p>
    <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
      <button class="btn-big" id="btnIngresar">Ingresar</button>
      <button class="btn-small" id="btnInfo">¬øC√≥mo usar?</button>
    </div>
  </div>
</div>

<!-- ---------- Modal ---------- -->
<div class="overlay" id="overlay">
  <div class="modal" id="modalContent"></div>
</div>

<!-- ---------- App principal ---------- -->
<div class="app" id="appRoot" aria-hidden="true">
  <div class="left">
    <div id="current-number">--</div>
    <div class="controls">
      <div class="number-display" id="numberDisplay">--</div>
      <div class="virtual-keyboard">
        <button class="key" data-key="1">1</button>
        <button class="key" data-key="2">2</button>
        <button class="key" data-key="3">3</button>
        <button class="key" data-key="4">4</button>
        <button class="key" data-key="5">5</button>
        <button class="key" data-key="6">6</button>
        <button class="key" data-key="7">7</button>
        <button class="key" data-key="8">8</button>
        <button class="key" data-key="9">9</button>
        <button class="key key-delete" data-key="delete">‚å´</button>
        <button class="key" data-key="0">0</button>
        <button class="key key-enter" data-key="enter">‚úì</button>
      </div>
      <div class="row">
        <button class="btn-bingo" id="btnBingo">üéâ Bingo</button>
      </div>
      <div class="muted-help">Mant√©n presionado un n√∫mero 5s para eliminarlo.</div>
    </div>
  </div>

  <div class="right">
    <div id="board"></div>
  </div>
</div>

<div class="restart-fixed">
  <button class="restart-btn" id="btnRestart">‚Üª</button>
</div>

<script>
const welcomeScreen = document.getElementById('welcomeScreen');
const appRoot = document.getElementById('appRoot');
const overlay = document.getElementById('overlay');
const modalContent = document.getElementById('modalContent');
const btnIngresar = document.getElementById('btnIngresar');
const btnInfo = document.getElementById('btnInfo');
const board = document.getElementById('board');
const currentNumberEl = document.getElementById('current-number');
const numberDisplay = document.getElementById('numberDisplay');
const btnBingo = document.getElementById('btnBingo');
const btnRestart = document.getElementById('btnRestart');

let totalNumeros = 90;
let markedSet = new Set();
let longPressDuration = 5000;
let currentInput = '';

// Teclado virtual
document.querySelectorAll('.key').forEach(key => {
  key.addEventListener('click', function() {
    const keyValue = this.getAttribute('data-key');
    
    if (keyValue === 'delete') {
      currentInput = currentInput.slice(0, -1);
    } else if (keyValue === 'enter') {
      if (currentInput) {
        addNumber(parseInt(currentInput));
        currentInput = '';
      }
    } else {
      // Solo permitir hasta 3 d√≠gitos
      if (currentInput.length < 3) {
        currentInput += keyValue;
      }
    }
    
    updateNumberDisplay();
  });
});

function updateNumberDisplay() {
  numberDisplay.textContent = currentInput || '--';
}

/* ---------- Modal ---------- */
function showModal({ title='', message='', buttons=[{text:'OK',action:()=>closeModal()}] }){
  const htmlButtons = buttons.map((b,i)=>`<button class="btn ${b.class||'btn-accept'}" data-i="${i}">${b.text}</button>`).join('');
  modalContent.innerHTML = `<h3>${title}</h3><p>${message}</p><div class="modal-actions">${htmlButtons}</div>`;
  overlay.classList.add('show');
  modalContent.querySelectorAll('button').forEach(btn=>{
    btn.onclick=()=>{buttons[parseInt(btn.dataset.i)].action()};
  });
}
function closeModal(){overlay.classList.remove('show');}

/* ---------- Inicio ---------- */
btnIngresar.onclick=()=>{
  showModal({
    title:'Selecciona tipo de bingo',
    message:'Elige cu√°ntos n√∫meros tendr√° el tablero.',
    buttons:[
      {text:'30',action:()=>startGame(30)},
      {text:'75',action:()=>startGame(75)},
      {text:'80',action:()=>startGame(80)},
      {text:'90',action:()=>startGame(90)},
      {text:'100',action:()=>startGame(100)},
      {text:'Cancelar',class:'btn-cancel',action:()=>closeModal()}
    ]
  });
};

btnInfo.onclick=()=>{
  showModal({
    title:'Instrucciones',
    message:`1) Usa el teclado para ingresar n√∫meros.<br>
             2) Presiona ‚úì para marcar el n√∫mero.<br>
             3) El n√∫mero se marcar√° en el tablero.<br>
             4) Mant√©n presionado un n√∫mero 5s para eliminarlo.`,
    buttons:[{text:'Entendido',action:()=>closeModal()}]
  });
};

/* ---------- Crear tablero ---------- */
function startGame(n){
  closeModal();
  totalNumeros=n;
  markedSet.clear();
  board.innerHTML='';
  currentInput = '';
  updateNumberDisplay();
  
  // Calcular columnas √≥ptimas para el tablero
  const columns = Math.ceil(Math.sqrt(n));
  
  for(let i=1;i<=n;i++){
    const d=document.createElement('div');
    d.className='number';
    d.textContent=i;
    d.id=`num-${i}`;
    attachLongPress(d,i);
    board.appendChild(d);
  }
  welcomeScreen.style.display='none';
  appRoot.style.display='flex';
  appRoot.setAttribute('aria-hidden','false');
  currentNumberEl.textContent='--';
}

function attachLongPress(el,num){
  let timer;
  const start=()=>{
    if(!el.classList.contains('marked'))return;
    timer=setTimeout(()=>{
      showModal({
        title:'Eliminar n√∫mero',
        message:`¬øQuitar el n√∫mero ${num}?`,
        buttons:[
          {text:'Eliminar',class:'btn-danger',action:()=>{unmark(num);closeModal();}},
          {text:'Cancelar',class:'btn-cancel',action:()=>closeModal()}
        ]
      });
    },longPressDuration);
  };
  const cancel=()=>clearTimeout(timer);
  el.addEventListener('mousedown',start);
  el.addEventListener('mouseup',cancel);
  el.addEventListener('mouseleave',cancel);
  el.addEventListener('touchstart',start);
  el.addEventListener('touchend',cancel);
  el.addEventListener('touchcancel',cancel);
}

function unmark(n){
  markedSet.delete(n);
  const e=document.getElementById(`num-${n}`);
  if(e)e.classList.remove('marked');
}

/* ---------- Aceptar ---------- */
function addNumber(n){
  if(isNaN(n)||n<1||n>totalNumeros){
    showModal({title:'N√∫mero inv√°lido',message:`Ingresa un n√∫mero entre 1 y ${totalNumeros}.`,buttons:[{text:'OK',action:()=>closeModal()}]});
    return;
  }
  if(markedSet.has(n)){
    showModal({title:'N√∫mero repetido',message:`El n√∫mero ${n} ya fue marcado.`,buttons:[{text:'OK',action:()=>closeModal()}]});
    return;
  }
  markedSet.add(n);
  document.getElementById(`num-${n}`).classList.add('marked');
  currentNumberEl.textContent=n;
  currentInput = '';
  updateNumberDisplay();
}

/* ---------- Bingo ---------- */
btnBingo.onclick=()=>{
  showModal({
    title:'¬°BINGO! üéâ',
    message:'¬°Felicidades! ya no hay premios',
    buttons:[
      {text:'S√≠, reiniciar',action:()=>{restart();closeModal();}},
      {text:'Cancelar',class:'btn-cancel',action:()=>closeModal()}
    ]
  });
};

/* ---------- Reiniciar ---------- */
btnRestart.onclick=()=>{
  showModal({
    title:'Opciones',
    message:'¬øReiniciar o volver al men√∫ principal?',
    buttons:[
      {text:'Reiniciar bingo',action:()=>{restart();closeModal();}},
      {text:'Men√∫ principal',class:'btn-cancel',action:()=>{toMenu();closeModal();}},
      {text:'Cancelar',class:'btn-cancel',action:()=>closeModal()}
    ]
  });
};

function restart(){
  markedSet.forEach(n=>{
    const e=document.getElementById(`num-${n}`);
    if(e)e.classList.remove('marked');
  });
  markedSet.clear();
  currentNumberEl.textContent='--';
  currentInput = '';
  updateNumberDisplay();
}

function toMenu(){
  restart();
  appRoot.style.display='none';
  welcomeScreen.style.display='flex';
  appRoot.setAttribute('aria-hidden','true');
}
</script>
</body>
</html>
